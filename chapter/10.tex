\chapter{向量微分}

\section{微分向量分析}

16. 向量的微分。 让我们考虑如下向量场：
$$\mathbf{u} = \alpha(x, y, z, t)\mathbf{i} + \beta(x, y, z, t)\mathbf{j} + \gamma(x, y, z, t)\mathbf{k} \quad (42)$$

在任意点 $P(x, y, z)$ 及任意时间 $t$，式 (42) 定义了一个向量。如果我们固定点 $P$，由于分量 $\alpha, \beta, \gamma$ 具有时间相关性，向量 $\mathbf{u}$ 仍会发生变化。如果我们固定时间，我们会注意到在点 $P(x, y, z)$ 处的向量通常与在以下点处的向量不同：

$$Q(x + dx, y + dy, z + dz)$$

在微积分中，学生已经学过如何计算 $x, y, z, t$ 的单函数变化。那么在向量的情况下，我们会遇到什么困难吗？实际上完全没有，因为我们很容易注意到，当且仅当向量的分量发生变化时，$\mathbf{u}$ 才会发生变化。因此，$\alpha(x, y, z, t)$ 的变化会产生 $\mathbf{u}$ 在 $x$ 方向上的变化，同理，$\beta$ 和 $\gamma$ 的变化分别产生 $\mathbf{u}$ 在 $y$ 和 $z$ 方向上的变化。由此，我们得出以下定义：

$$\mathbf{du} = d\alpha\,\mathbf{i} + d\beta\,\mathbf{j} + d\gamma\,\mathbf{k} \quad (43)$$

$$\begin{aligned} \mathbf{du} = &\left( \frac{\partial \alpha}{\partial x} dx + \frac{\partial \alpha}{\partial y} dy + \frac{\partial \alpha}{\partial z} dz + \frac{\partial \alpha}{\partial t} dt \right) \mathbf{i} \\ &+ \left( \frac{\partial \beta}{\partial x} dx + \frac{\partial \beta}{\partial y} dy + \frac{\partial \beta}{\partial z} dz + \frac{\partial \beta}{\partial t} dt \right) \mathbf{j} \\ &+ \left( \frac{\partial \gamma}{\partial x} dx + \frac{\partial \gamma}{\partial y} dy + \frac{\partial \gamma}{\partial z} dz + \frac{\partial \gamma}{\partial t} dt \right) \mathbf{k} \end{aligned}$$

例如，设 $\mathbf{r} = x\mathbf{i} + y\mathbf{j} + z\mathbf{k}$ 为三维空间中运动质点 $P(x, y, z)$ 的位置向量。则：
$$\mathbf{dr} = dx\,\mathbf{i} + dy\,\mathbf{j} + dz\,\mathbf{k}$$

以及
$$\mathbf{v} = \frac{d\mathbf{r}}{dt} = \frac{dx}{dt}\mathbf{i} + \frac{dy}{dt}\mathbf{j} + \frac{dz}{dt}\mathbf{k} \quad (44)$$

$$\mathbf{a} = \frac{d^2\mathbf{r}}{dt^2} = \frac{d^2x}{dt^2}\mathbf{i} + \frac{d^2y}{dt^2}\mathbf{j} + \frac{d^2z}{dt^2}\mathbf{k} \quad (45)$$

根据定义，方程 (44) 和 (45) 分别是质点的速度和加速度。我们假设向量 $\mathbf{i, j, k}$ 在空间中保持固定。

如果向量 $\mathbf{u}$ 仅取决于单个变量 $t$，我们可以定义：
$$\frac{d\mathbf{u}}{dt} = \lim_{\Delta t \to 0} \frac{\mathbf{u}(t + \Delta t) - \mathbf{u}(t)}{\Delta t} \quad (46)$$

很容易验证 (46) 与 (43) 是等价的。

例 14。 考虑一个质点 $P$ 在半径为 $r$ 的圆上以恒定角速度 $\omega = \frac{d\theta}{dt}$ 运动（见图 28）。我们注意到：

$$\mathbf{r} = r \cos \theta\,\mathbf{i} + r \sin \theta\,\mathbf{j}$$

因此：
$$\mathbf{v} = \frac{d\mathbf{r}}{dt} = (-r \sin \theta\,\mathbf{i} + r \cos \theta\,\mathbf{j}) \frac{d\theta}{dt}$$

以及：
$$\mathbf{a} = \frac{d\mathbf{v}}{dt} = \frac{d^2\mathbf{r}}{dt^2} = (-r \cos \theta\,\mathbf{i} - r \sin \theta\,\mathbf{j}) \left( \frac{d\theta}{dt} \right)^2$$

所以加速度为：
$$\mathbf{a} = -\omega^2\mathbf{r} \quad (47)$$

点 $P$ 具有指向原点的加速度，其大小为恒定的 $\omega^2r$。这个加速度是由于速度向量以恒定速率改变方向而产生的；它被称为向心加速度。

例 15。 设 $P$ 为空间曲线上的任意一点（见图 29）：

$$\begin{aligned} x &= x(s) \\ y &= y(s) \\ z &= z(s) \end{aligned} \text{}$$

其中 $s$ 是从某个固定点 $Q$ 开始测量的弧长。那么：

$$\mathbf{r} = x(s)\mathbf{i} + y(s)\mathbf{j} + z(s)\mathbf{k} \quad (48) \text{}$$

因此：
$$\frac{d\mathbf{r}}{ds} = \frac{dx}{ds}\mathbf{i} + \frac{dy}{ds}\mathbf{j} + \frac{dz}{ds}\mathbf{k} \quad (49) \text{}$$

并且由微积分可知：
$$\begin{aligned} \frac{d\mathbf{r}}{ds} \cdot \frac{d\mathbf{r}}{ds} &= \left( \frac{dx}{ds} \right)^2 + \left( \frac{dy}{ds} \right)^2 + \left( \frac{dz}{ds} \right)^2 \\ &= \frac{dx^2 + dy^2 + dz^2}{ds^2} \equiv 1 \end{aligned} \text{}$$

因此 $\frac{d\mathbf{r}}{ds}$ 是一个单位向量。当 $\Delta s \to 0$ 时，$\frac{\Delta\mathbf{r}}{\Delta s}$ 的位置趋近于点 $P$ 处的切线。因此，(49) 代表了空间曲线 (48) 的单位切向量。

17. 微分规则。 考虑：

$$\begin{aligned} \varphi(t) &= \mathbf{u}(t) \cdot \mathbf{v}(t) \\ \varphi(t + \Delta t) - \varphi(t) &= \mathbf{u}(t + \Delta t) \cdot \mathbf{v}(t + \Delta t) - \mathbf{u}(t) \cdot \mathbf{v}(t) \end{aligned}$$

现在：
$$\begin{aligned} \mathbf{u}(t + \Delta t) &= \mathbf{u}(t) + \Delta\mathbf{u} \\ \mathbf{v}(t + \Delta t) &= \mathbf{v}(t) + \Delta\mathbf{v} \end{aligned}$$

（见图 27），所以：
$$\frac{\varphi(t + \Delta t) - \varphi(t)}{\Delta t} = \mathbf{u} \cdot \frac{\Delta\mathbf{v}}{\Delta t} + \frac{\Delta\mathbf{u}}{\Delta t} \cdot \mathbf{v} + \frac{\Delta\mathbf{u}}{\Delta t} \cdot \Delta\mathbf{v}$$

取极限，我们得到：
$$\frac{d(\mathbf{u} \cdot \mathbf{v})}{dt} = \mathbf{u} \cdot \frac{d\mathbf{v}}{dt} + \frac{d\mathbf{u}}{dt} \cdot \mathbf{v} \quad (50)$$

类似地：
$$\frac{d(\mathbf{u} \times \mathbf{v})}{dt} = \mathbf{u} \times \frac{d\mathbf{v}}{dt} + \frac{d\mathbf{u}}{dt} \times \mathbf{v} \quad (51)$$

$$\frac{d(f\mathbf{u})}{dt} = f\frac{d\mathbf{u}}{dt} + \frac{df}{dt}\mathbf{u} \quad (52)$$

请注意这些公式与微积分规则的一致性。

例 16。 设 $\mathbf{u}(t)$ 为一个模（大小）恒定的向量。因此：

$$\mathbf{u} \cdot \mathbf{u} = u^2 = \text{常数}$$

通过微分，我们得到：

$$\begin{aligned} \mathbf{u} \cdot \frac{d\mathbf{u}}{dt} + \frac{d\mathbf{u}}{dt} \cdot \mathbf{u} &= 0 \\ 
\mathbf{u} \cdot \frac{d\mathbf{u}}{dt} &= 0 \end{aligned}$$

因此，要么 $\frac{d\mathbf{u}}{dt} = 0$，要么 $\frac{d\mathbf{u}}{dt}$ 与 $\mathbf{u}$ 垂直。这是一个重要的结果，学生应当充分理解。读者应给出该定理的几何证明。

例 17。在所有情况下，$\mathbf{u} \cdot \mathbf{u} = u^2$，其中 $u$ 是 $\mathbf{u}$ 的长度。微分得：
$$2\mathbf{u} \cdot \frac{d\mathbf{u}}{dt} = 2u \frac{du}{dt}$$

以及：
$$\mathbf{u} \cdot \frac{d\mathbf{u}}{dt} = u \frac{du}{dt} \quad (53)$$

这一结果并非显而易见，因为 $|d\mathbf{u}| \neq du$。

例 18：平面运动。现在 $\mathbf{r} = r\mathbf{R}$，其中 $\mathbf{R}$ 是一个单位向量（见图 30）。因此：
$$\mathbf{v} = \frac{d\mathbf{r}}{dt} = \frac{dr}{dt}\mathbf{R} + r\frac{d\mathbf{R}}{dt}$$

由于 $\mathbf{R}$ 是单位向量，根据例 16，$\frac{d\mathbf{R}}{dt}$ 与 $\mathbf{R}$ 垂直。同时，通过对 $\mathbf{R} = \cos \theta\,\mathbf{i} + \sin \theta\,\mathbf{j}$ 进行微分，我们可以很容易验证 $|\frac{d\mathbf{R}}{dt}| = \frac{d\theta}{dt}$。因此 $\mathbf{v} = \frac{dr}{dt}\mathbf{R} + r\frac{d\theta}{dt}\mathbf{P}$，其中 $\mathbf{P}$ 是垂直于 $\mathbf{R}$ 的单位向量。再次微分得：
$$\mathbf{a} = \frac{d\mathbf{v}}{dt} = \frac{d^2r}{dt^2}\mathbf{R} + \frac{dr}{dt}\frac{d\mathbf{R}}{dt} + \frac{dr}{dt}\frac{d\theta}{dt}\mathbf{P} + r\frac{d^2\theta}{dt^2}\mathbf{P} + r\frac{d\theta}{dt}\frac{d\mathbf{P}}{dt}$$

或：
$$\mathbf{a} = \left[ \frac{d^2r}{dt^2} - r\left( \frac{d\theta}{dt} \right)^2 \right] \mathbf{R} + \left[ 2\frac{dr}{dt}\frac{d\theta}{dt} + r\frac{d^2\theta}{dt^2} \right] \mathbf{P}$$

因为：
$$\frac{d\mathbf{P}}{dt} = -\frac{d\theta}{dt}\mathbf{R} \quad (54)$$

因此：
$$\mathbf{a} = \left[ \frac{d^2r}{dt^2} - r\left( \frac{d\theta}{dt} \right)^2 \right] \mathbf{R} + \frac{1}{r} \frac{d}{dt} \left( r^2 \frac{d\theta}{dt} \right) \mathbf{P} \quad (55)$$

18. 梯度

设 $\varphi(x, y, z)$ 为任意连续可微的空间函数。根据微积分：
$$d\varphi = \frac{\partial \varphi}{\partial x} dx + \frac{\partial \varphi}{\partial y} dy + \frac{\partial \varphi}{\partial z} dz \quad (56)$$

现在设 $\mathbf{r}$ 为指向点 $P(x, y, z)$ 的位置向量：
$$\mathbf{r} = x\mathbf{i} + y\mathbf{j} + z\mathbf{k}$$

如果我们移动到点 $Q(x + dx, y + dy, z + dz)$（见图 32），则：
$$d\mathbf{r} = dx\,\mathbf{i} + dy\,\mathbf{j} + dz\,\mathbf{k}$$

现在注意到式 (56) 包含了项 $dx, dy, dz$ 以及项 $\frac{\partial \varphi}{\partial x}, \frac{\partial \varphi}{\partial y}, \frac{\partial \varphi}{\partial z}$。我们定义一个由 $\varphi$ 的三个偏导数组成的新向量。令 $\text{del}\,\varphi \equiv \nabla\varphi \equiv \text{gradient}\,\varphi$（$\varphi$ 的梯度）定义为：

$$\nabla\varphi = \frac{\partial \varphi}{\partial x}\mathbf{i} + \frac{\partial \varphi}{\partial y}\mathbf{j} + \frac{\partial \varphi}{\partial z}\mathbf{k} \quad (57)$$

我们立即可以看到：
$$d\varphi = d\mathbf{r} \cdot \nabla\varphi \quad (58)$$

梯度的几何解释

我们现在给出 $\nabla\varphi$ 的几何解释。在点 $P(x_0, y_0, z_0)$ 处，$\varphi$ 的值为 $\varphi(x_0, y_0, z_0)$，因此：
$$\varphi(x, y, z) = \varphi(x_0, y_0, z_0)$$

表示一个显然包含点 $P(x_0, y_0, z_0)$ 的曲面（等值面）。

只要我们沿着这个曲面移动，$\varphi$ 就具有恒定值 $\varphi(x_0, y_0, z_0)$，且 $d\varphi = 0$。因此，根据式 (58)：
$$d\mathbf{r} \cdot \nabla\varphi = 0 \quad (59)$$

由于 $\nabla\varphi$ 是一个在 $\varphi$ 被求导后就完全确定的向量，而式 (59) 表明，只要 $d\mathbf{r}$ 表示从 $P$ 到 $Q$ 的位移且 $Q$ 仍在 $\varphi = \text{常数}$ 的曲面上，$\nabla\varphi$ 就与 $d\mathbf{r}$ 垂直。

因此，$\nabla\varphi$ 垂直于曲面在 $P$ 点处所有可能的切线，所以 $\nabla\varphi$ 必然正交（垂直）于曲面 $\varphi(x, y, z) = \text{常数}$。

（接上页图 33）。现在让我们回到公式 $d\varphi = d\mathbf{r} \cdot \nabla\varphi$。向量 $\nabla\varphi$ 在任何给定点 $P(x, y, z)$ 都是固定的，因此 $d\varphi$（$\varphi$ 的变化量）在很大程度上取决于 $d\mathbf{r}$。

显然，当 $d\mathbf{r}$ 与 $\nabla\varphi$ 平行时，$d\varphi$ 取得最大值，因为 $d\mathbf{r} \cdot \nabla\varphi = |d\mathbf{r}||\nabla\varphi| \cos \theta$，而 $\cos \theta$ 在 $\theta = 0^\circ$ 时达到最大值。因此，$\nabla\varphi$ 的方向是函数 $\varphi(x, y, z)$ 增加最快的方向。

设 $|d\mathbf{r}| = ds$，则有：
$$\frac{d\varphi}{ds} = \mathbf{u} \cdot \nabla\varphi \quad (60)$$

设 $|d\mathbf{r}| = ds$，则有：
$$\frac{d\varphi}{ds} = \mathbf{u} \cdot \nabla\varphi \quad (60)$$

其中 $\mathbf{u}$ 是沿 $d\mathbf{r}$ 方向的单位向量。因此，$\varphi$ 在任何方向上的变化率，就是 $\nabla\varphi$ 在该方向单位向量上的投影。

示例解析例 

19： 求曲面 $x^2 + y^2 - z = 1$ 在点 $P(1, 1, 1)$ 处的单位法向量。

这里，$\varphi(x, y, z) = x^2 + y^2 - z$。

$\nabla\varphi = 2x\mathbf{i} + 2y\mathbf{j} - \mathbf{k}$。

在点 $P(1, 1, 1)$ 处，$\nabla\varphi = 2\mathbf{i} + 2\mathbf{j} - \mathbf{k}$。

因此，单位法向量为：

$$\mathbf{N} = \frac{2\mathbf{i} + 2\mathbf{j} - \mathbf{k}}{3}$$

(注：分母 3 是向量长度 $\sqrt{2^2 + 2^2 + (-1)^2}$)

例 20： 若 $r = (x^2 + y^2 + z^2)^{\frac{1}{2}}$，求 $\nabla r$。

曲面 $r = \text{常数}$ 是一个球面。

因此 $\nabla r$ 与球面正交，也就是说它与位置向量 $\mathbf{r}$ 平行。

故 $\nabla r = k\mathbf{r}$。根据公式 (53) 有 $dr = d\mathbf{r} \cdot \nabla r = k d\mathbf{r} \cdot \mathbf{r} = kr\,dr$。

因此 $k = \frac{1}{r}$，且：
$$\nabla r = \frac{\mathbf{r}}{r} = \mathbf{R}$$

(此处 $\mathbf{R}$ 表示径向单位向量)

例 21：
$$\nabla f(u) = f'(u) \nabla u, \quad u = u(x, y, z)$$

(这是梯度运算的链式法则)

