\chapter{不定积分和积分方法}
不定积分的概念起源于17世纪，由艾萨克·牛顿和戈特弗里德·莱布尼兹独立发展，作为微积分学的基础。

不定积分也称为反导函数或原函数，它本质上是求导数的逆运算，用于找到一个函数的“原始形式”。

\section{不定积分的基本概念}
考虑微分表达式 $dF(x) = F(x + \epsilon) - F(x)$，我们希望用数学的方法由微分 $dF(x)$ 返回原函数 $F(x)$,这时我们可以定义一个专用符号如 $\int$ 来表示这种运算操作，即
\begin{align*}
    \int\,dF(x) = F(x)
\end{align*}
由此我们可以进行一些基本运算：
\begin{align*}
    \int\,dx = x \qquad \int\,d(\ln x + \sin x) = \ln x + \sin x \\
    F(x) = x^2 + 2x + 3 \Rightarrow \int\,dF(x) = x^2 + 2x + 3
\end{align*}

接下来考虑微分的导数展开形式：
\begin{align}
    dF(x) = f(x)\,dx
\end{align}
如果等式（5.1）从右向左计算：
\begin{align}
    f(x)\,dx = d(F(x) + C) = [F(x+\epsilon) + C] - [F(x) + C] = F(x + \epsilon) - F(x)
\end{align}
其中 $C$ 为任意常数。也就是说导函数 $f(x)$ 对应的不是唯一原函数 $F(x)$，而是一个原函数集合 $F(x) + C$。所以我们有
\begin{align}
    \int f(x)\,dx = \int\,d(F(x) + C) = F(x) + C
\end{align}
如果我们将等式（5.2）看作众所周知的常识，为了避免计算中间过程的繁琐性，作为一种约定，我们省略微分表达式中的常数项 $C$，而只是在最终结果中列出。这样等式（5.3）就变成：
\begin{align}
    \int f(x)\,dx = \int\,dF(x) = F(x) + C
\end{align}
这样，我们就完成了由导函数推导计算原函数的过程，并可据此总结出不定积分的定义。

\begin{definition}{不定积分}

    不定积分是微分的逆运算，作用于微分表达式并解析出原函数。用符号 $\int$ 表示不定积分，我们有
    \begin{align}
        \int\,dF(x) = F(x)
    \end{align}
    对于以导函数表示的微分展开形式，不定积分的运算结果是原函数（相对于导函数）的集合，即
    \begin{align}
        \int f(x)\,dx = \int\,dF(x) = F(x) + C
    \end{align}
\end{definition}
在不定积分表达式中微分自变量 $dx$ 也称为积分自变量。

\medskip

\textbf{不定积分与微分的互逆关系}

微分： 给定一个函数 $F(x)$，求其导数 $\frac{dF(x)}{dx} = f(x)$。

不定积分： 给定一个函数 $f(x)$，求其原函数 $F(x)$，即 $\int f(x)\,dx = F(x) + C$。

逆运算体现： 不定积分正是微分（求导数）的逆过程。如果对一个函数先求导，再求不定积分，会回到原来的函数（相差一个常数 $C$）。
$$\int \frac{dF(x)}{dx}\,dx = \int f(x)\,dx = F(x) + C$$
如果对一个函数先求不定积分，再求导，就会回到原来的函数。
$$\frac{d}{dx} \left(\int f(x)\,dx\right) = \frac{d}{dx} (F(x) + C) = f(x)$$

\begin{center}
\begin{tikzpicture}[
    % 样式定义
    function/.style={font=\color{blue!70!black}\large}, 
    op_arrow/.style={very thick, draw=black, >=stealth}
]

% 1. 定义节点 (Functions)
\node[function] (Fx) at (0, 0) {$F(x)$};
\node[function, right=3.5cm of Fx] (dFx) {$dF(x)$};
\node[function, right=3.5cm of dFx] (fx) {$f(x)$};


% --- 上半部分: 微分标签 (方向: F(x) -> dF(x) -> f(x)) ---
% 路径 1: F(x) -> dF(x)
\draw[->, op_arrow] (Fx.north) to[out=60, in=120] node[midway, above, label] {微分} (dFx.north);
% 路径 2: dF(x) -> f(x)
\draw[->, op_arrow] (dFx.north) to[out=60, in=120] node[midway, above, label] {$\frac{dF(x)}{dx}$} (fx.north);


% --- 下半部分: 积分标签 (方向: f(x) -> dF(x) -> F(x)) ---
% 路径 3: f(x) -> dF(x)
\draw[->, op_arrow] (fx.south) to[out=-120, in=-60] node[midway, below, label] {$f(x) \cdot dx$} (dFx.south);
% 路径 4: dF(x) -> F(x)
\draw[->, op_arrow] (dFx.south) to[out=-120, in=-60] node[midway, below, label] {积分} (Fx.south);

\end{tikzpicture}
\end{center}


\section{基本积分公式}
将第三章的导数公式或微分公式进行适当变换，即可得到常用积分公式。

\medskip

\textbf{基本积分公式}
\begin{align*}
    &(1)\; \int k \, du = ku + C \quad (\text{其中 } k \text{ 是常数}) \\
    &(2)\; \int u^n \, du = \frac{1}{n+1}u^{n+1} + C \quad (n \neq -1) \\
    &(3)\; \int \frac{1}{u} \, du = \ln|u| + C \\
    &(4)\; \int e^u \, du = e^u + C \\
    &(5)\; \int a^u \, du = \frac{a^u}{\ln a} + C \quad (a > 0, a \neq 1) \\
    &(6)\; \int \sin u \, du = -\cos u + C \\
    &(7)\; \int \cos u \, du = \sin u + C \\
    &(8)\; \int \sec^2 u \, du = \tan u + C \\
    &(9)\; \int \csc^2 u \, du = -\cot u + C \\
    &(10)\; \int \sec u \tan u \, du = \sec u + C \\
    &(11)\; \int \csc u \cot u \, du = -\csc u + C \\
    &(12)\; \int \tan u \, du = -\ln|\cos u| + C = \ln|\sec u| + C \\
    &(13)\; \int \cot u \, du = \ln|\sin u| + C = -\ln|\csc u| + C \\
    &(14)\; \int \sec u \, du = \ln|\sec u + \tan u| + C \\
    &(15)\; \int \csc u \, du = -\ln|\csc u + \cot u| + C = \ln|\csc u - \cot u| + C \\
    &(16)\; \int \frac{1}{\sqrt{a^2 - u^2}} \, du = \arcsin\left(\frac{u}{a}\right) + C \quad (a > 0) \\
    &(17)\; \int \frac{1}{a^2 + u^2} \, du = \frac{1}{a} \arctan\left(\frac{u}{a}\right) + C \quad (a \neq 0) \\
    &(18)\; \int \frac{1}{u\sqrt{u^2 - a^2}} \, du = \frac{1}{a} \operatorname{arcsec}\left(\frac{|u|}{a}\right) + C \quad (a > 0)
\end{align*}

\medskip

对于公式（10）：
\begin{align*}
    \int \sec u \tan u \, du &= \int \frac{1}{\cos u}\cdot \frac{\sin u}{\cos u}\,dx \\
    &= \int\frac{d(-\cos u)}{(\cos u)^2} = -\frac{1}{-2 + 1}(\cos u)^{-2+1} \\
    &= \frac{1}{\cos u} = \sec u
\end{align*}
对于公式（14）：
\begin{align*}
    \int \sec u \, du &= \int \sec u \cdot \frac{\sec u + \tan u}{\sec u + \tan u} \, du \\
    &= \int \frac{\sec u (\sec u + \tan u)}{\sec u + \tan u} \, du \\
    &= \int \frac{\sec^2 u + \sec u \tan u}{\sec u + \tan u} \, du
\end{align*}
令 $w = \sec u + \tan u$，回忆导数公式：
\begin{align*}
    &\frac{d\sec u}{du} = \sec u \tan u \qquad \frac{d\tan u}{du} = \sec^2 u \\
    &\frac{dw}{du} = \frac{d}{du}(\sec u + \tan u) = \sec u \tan u + \sec^2 u \\
    &dw = (\sec^2 u + \sec u \tan u) \, du
\end{align*}
将换元结果 $w$ 和 $dw$ 代入原积分表达式：
\begin{align*}
    \int \frac{\sec^2 u + \sec u \tan u}{\sec u + \tan u} \, du &= \int \frac{1}{w} \, dw \\
    &= \ln|w| + C \\
    &= \ln|\sec u + \tan u| + C
\end{align*}
因此，我们推导出：$$\int \sec u \, du = \ln|\sec u + \tan u| + C$$

\medskip

对于公式（16），（17），（18），我们可以利用微分公式从右侧向左侧推导出结果。积分公式的直接推导我们在稍后的积分方法中给出。


\section{积分技术}
本节主要聚焦于不定积分的求解方法。

\medskip

\textbf{1. 替换法}

替换法（也称为换元法）用于简化积分变量，通过引入新变量 $u = g(x)$ ，使积分形式更简单。步骤：

（1）选择 $u = g(x)$，计算 $du = g'(x)\,dx$。

（2）用 $u$ 和 $du$ 替换原积分。

（3）求新积分，然后反代回 $x$。

（4）添加常数 $C$。

适用场景：复合函数，如 $\int f(g(x))g'(x)\,dx$。

注意：替换后积分应完全用 $u$ 表示。

\medskip

\begin{example} 计算不定积分。

    $(1)\; \int x\sqrt{x^2 + 1} \,dx$
    
    令 $u = x^2 + 1$，则 $du = d(x^2 + 1) = 2x \,dx$，所以 $x \,dx = \frac{1}{2} \,du$
    \begin{align*}
        \int x\sqrt{x^2 + 1} \,dx &= \int \sqrt{x^2 + 1}\cdot x \,dx = \frac{1}{2}\int \sqrt{u} \,du \\
        &= \frac{1}{2}\cdot\frac{1}{\frac{1}{2}+1}u^{\frac{1}{2}+1} + C \\
        &= \frac{1}{2}\cdot\frac{2}{3}u^{\frac 3 2} + C \\
        &= \frac{1}{3}(x^2 + 1)^{\frac 3 2} + C
    \end{align*}

    $(2)\; \int e^{3x-5} \,dx$

    令 $u = 3x - 5$，则 $du = d(3x - 5) = 3 \,dx$，所以 $dx = \frac{1}{3} \,du$
    \begin{align*}
        \int e^{3x-5} \,dx &= \int e^u \cdot\frac{1}{3} \,du = \frac{1}{3}\int e^u \,du \\
        &= \frac{1}{3} e^u + C \\
        &= \frac{1}{3} e^{3x -5} + C
    \end{align*}

    $(3)\; \int \frac{x}{\sqrt{x^2 + 4}} \,dx$

    令 $u = x^2 + 4$，则 $du = d(x^2 + 4) = 2x \,dx$，所以 $x \,dx = \frac{1}{2} \,du$
    \begin{align*}
        \int \frac{x}{\sqrt{x^2 + 4}} \,dx &= \int \frac{1}{\sqrt{u}} \left(\frac{1}{2} \,du\right) \\
        &= \frac{1}{2} \int u^{-1/2} \,du = \frac{1}{2} \left( \frac{u^{1/2}}{1/2} \right) + C \\
        &= u^{1/2} + C = \sqrt{x^2 + 4} + C
    \end{align*}
\end{example}

替换法的关键在于选择正确的 $u$，使 $du$ 能够简化或消除原积分式中剩余的 $x$ 变量。

\medskip

\textbf{2. 分部积分法}

分部积分法源于乘积求导法则：$$(uv)' = u'v + uv'$$
对等式两边求积分：$$\int (uv)' \,dx = \int u'v \,dx + \int uv' \,dx$$
等式的左边 $\int (uv)' \,dx = \int \,d(uv) = uv$，因此：$$uv = \int v \,du + \int u \,dv$$
稍作移项，就得到了分部积分公式：
\begin{align}
    \int u \,dv = uv - \int v \,du
\end{align}

分部积分法的核心在于将一个难以求解的积分 $\int u \,dv$ 转化为一个相对更容易求解的积分 $\int v \,du$。

\medskip

\begin{example} 求 $\int x e^{x} \,dx$。

    首先将积分转化为 $\int u \,dv$ 的形式：$\int x e^{x} \,dx = \int x \,de^x$。

    对照公式，$u = x,\quad v = e^x$，所以
    \begin{align*}
        \int x e^{x} \,dx ^= \int x \,de^x \\
        &= x\cdot e^x - \int e^x \,dx \\
        &= xe^x - e^x + C
    \end{align*}
\end{example}

\begin{example} 求 $\int \ln x \,dx$。

    对照公式，$u = \ln x,\quad v = x$，所以
    \begin{align*}
        \int \ln x \,dx &= \ln x \cdot x - \int x \,d \ln x \\
        &= x\ln x - \int x\cdot\left(\frac 1 x\right) \,dx \\
        &= x\ln x - x + C
    \end{align*}
\end{example}

\begin{example} 求解 $\int x\cos x \,dx$。

    首先将积分转化为 $\int u \,dv$ 的形式：$\int x\cos x \,dx = \int x \,d\sin x$。

    对照公式，$u = x,\quad v = \sin x$，所以
    \begin{align*}
        \int x\cos x \,dx &= \int x \,d\sin x \\
        &= x\cdot\sin x - \int \sin x \,dx \\
        &= x\sin x - (-\cos x) \\
        &= x\sin x + \cos x + C
    \end{align*}
\end{example}

\begin{example} 求解 $\int x^2 e^x \,dx$。
    \begin{align*}
        \int x^2 e^x \,dx &= \int x^2 \,de^x = x^2\cdot e^x - \int e^x \,dx^2 \\
        &= x^2 e^x - \int e^x\cdot 2x \,dx = x^2e^x - 2\int x \,de^x\\
        &= x^2e^x - 2\left[x\cdot e^x - \int e^x \,dx \right] \\
        &= x^2e^x - 2xe^x + 2e^x + C \\
        &= (x^2 - 2x + 2)e^x + C
    \end{align*}
\end{example}

分部积分法重要的不是用 $u$ 和 $v$ 进行变量替换，而是形成 $\int u \,dv$ 的形式，然后写出紧凑并且逻辑连贯的解题过程。

\medskip

\textbf{3. 部分分式法}

部分分式法是一种代数技巧，用于将有理函数（即两个多项式的比值）分解为几个更简单的分式之和。这种分解是积分有理函数时非常重要的一步，因为它能将复杂的积分问题转化为更容易解决的基本积分形式。

\medskip

（1）适用条件与预处理

部分分式法仅适用于真有理函数的积分，即分子多项式的次数低于分母多项式的次数。

如果是非真有理函数（分子次数 $\ge$ 分母次数），必须先使用多项式长除法将其分解为一个多项式（可直接积分）和一个真有理函数，然后对剩下的真有理函数部分应用部分分式法。例如
$$\int \frac{x^3 + x}{x^2 - 4} \,dx$$
需要先进行长除法：$\frac{x^3 + x}{x^2 - 4} = x + \frac{5x}{x^2 - 4}$。接下来只需要对 $\frac{5x}{x^2 - 4}$ 应用部分分式法。

\medskip

（2）部分分式分解的步骤

部分分式法的核心在于分解分母。一旦分母被分解成因子，就可以根据这些因子的类型来构建部分分式。

\medskip

步骤一：分解分母

将分母多项式分解为实系数的一次因子（形如 $ax+b$）和不可再分解的二次因子（形如 $ax^2 + bx + c$，其中 $b^2 - 4ac < 0$）的乘积。

\medskip

步骤二：构建部分分式
根据分母分解的因子类型，构造待定的部分分式形式。主要有以下四种情况：

$$
\begin{array}{ll}
    \text{分母因子类型} &\quad \text{对应的部分分式形式} \\
    \hline
    \text{I. 不同的线性因子 } (ax+b) &\quad \frac{A}{ax+b} \\
    \text{II. 重复的线性因子 } (ax+b)^n &\quad \frac{A_1}{ax+b} + \frac{A_2}{(ax+b)^2} + \dots \\
    \text{III. 不同的不可分解二次因子 }(ax^2+bx+c) &\quad \frac{Ax+B}{ax^2+bx+c} \\
    \text{IV. 重复的不可分解二次因子 } (ax^2+bx+c)^n &\quad \frac{A_1x+B_1}{ax^2+bx+c} + \frac{A_2x+B_2}{(ax^2+bx+c)^2} + \dots
\end{array}
$$

步骤三：确定待定系数

将构建的部分分式相加，然后与原始的分子多项式设为相等。有以下两种常用方法确定待定系数（$A, B, C, \dots$）：

特值法 对于线性因子，选择能使分母中某个因子为零的 $x$ 值代入方程，从而快速求解一些系数。

系数比较法: 将方程两边多项式按 $x$ 的幂次展开并合并同类项，然后比较等式两边 $x^n$ 项的系数，得到一个线性方程组，求解该方程组。

步骤四：进行积分

将确定系数后的部分分式代回积分式中，然后分别对每一项进行积分。

线性因子项 $\int \frac{A}{ax+b} \,dx$ 通常使用对数 $\frac{A}{a} \ln|ax+b| + C$。

不可分解二次因子项 $\int \frac{Ax+B}{ax^2+bx+c} \,dx$ 通常需要配方，拆分成 $\ln$ 形式和 $\arctan$ 形式的组合。

\medskip

\begin{example} 求积分 $\int \frac{1}{x^2 - 5x + 6} \,dx$。

    步骤一：分解分母分母 
    
    $x^2 - 5x + 6$ 可分解为 $(x-2)(x-3)$。

    步骤二：构建部分分式（类型 I）
    $$\frac{1}{x^2 - 5x + 6} = \frac{1}{(x-2)(x-3)} = \frac{A}{x-2} + \frac{B}{x-3}$$

    步骤三：确定待定系数
    
    通分并比较分子：$$1 = A(x-3) + B(x-2)$$
    所以，$$\frac{1}{x^2 - 5x + 6} = \frac{-1}{x-2} + \frac{1}{x-3}$$

    步骤四：进行积分
    \begin{align*}
        \int \frac{1}{x^2 - 5x + 6} \,dx &= \int \left( \frac{1}{x-3} - \frac{1}{x-2} \right) \,dx \\
        &= \int \frac{1}{x-3} \,dx - \int \frac{1}{x-2} \,dx \\
        &= \ln|x-3| - \ln|x-2| + C \\
        &= \ln \left| \frac{x-3}{x-2} \right| + C
    \end{align*}
\end{example}

\begin{example} 求积分：$$\int \frac{x^3 + 4x^2 - x + 1}{x(x^2 + 1)^2} \,dx$$
    步骤一：分解分母与构建部分分式
    
    分母已经分解：$x(x^2 + 1)^2$。
    
    $x$: 不同的线性因子。
    
    $(x^2 + 1)^2$: 重复的不可分解二次因子。根据分解规则，构造部分分式：
    $$\frac{x^3 + 4x^2 - x + 1}{x(x^2 + 1)^2} = \frac{A}{x} + \frac{Bx + C}{x^2 + 1} + \frac{Dx + E}{(x^2 + 1)^2}$$

    步骤二：确定待定系数
    
    通分并比较分子：$$x^3 + 4x^2 - x + 1 = A(x^2 + 1)^2 + (Bx + C)x(x^2 + 1) + (Dx + E)x$$

    展开并分组：
    \begin{align*}
        &x^3 + 4x^2 - x + 1 \\
        &= A(x^4 + 2x^2 + 1) + (Bx^2 + Cx)(x^2 + 1) + Dx^2 + Ex \\
        &= Ax^4 + 2Ax^2 + A + Bx^4 + Bx^2 + Cx^3 + Cx + Dx^2 + Ex \\
        &= (A + B)x^4 + (C)x^3 + (2A + B + D)x^2 + (C + E)x + (A)
    \end{align*}

    比较等式两边 $x^n$ 项的系数：
$$
\begin{array}{llll}
    $x$ \text{的幂次} &\qquad \text{左边系数} &\qquad \text{右边系数} &\qquad \text{得到的方程} \\
    \hline
    x^4 &\qquad 0 &\qquad A+B &\qquad (1)\; A + B = 0 \\
    x^3 &\qquad 1 &\qquad C &\qquad (2)\; C = 1 \\
    x^2 &\qquad 4 &\qquad 2A+B+D &\qquad (3)\; 2A + B + D = 4 \\
    x^1 &\qquad -1 &\qquad C+E &\qquad (4)\; C + E = -1 \\
    x^0 \text{(常数项)} &\qquad 1 &\qquad A &\qquad (5)\; A = 1 \\
\end{array}
$$

    求解系数：
    
    由 (5) 得 $A = 1$。
    
    由 (2) 得 $C = 1$。
    
    将 $A=1$ 代入 (1) 得 $1 + B = 0 \Rightarrow B = -1$。
    
    将 $C=1$ 代入 (4) 得 $1 + E = -1 \Rightarrow E = -2$。
    
    将 $A=1$ 和 $B=-1$ 代入 (3) 得 $2(1) + (-1) + D = 4 \Rightarrow 1 + D = 4 \Rightarrow D = 3$。

    分解结果：
    $$\frac{x^3 + 4x^2 - x + 1}{x(x^2 + 1)^2} = \frac{1}{x} + \frac{-x + 1}{x^2 + 1} + \frac{3x - 2}{(x^2 + 1)^2}$$

    步骤三：进行积分
    $$\int \frac{1}{x} \,dx + \int \frac{1-x}{x^2 + 1} \,dx + \int \frac{3x - 2}{(x^2 + 1)^2} \,dx$$

    第一项 (线性因子)$$\int \frac{1}{x} \,dx = \\ln|x|$$
    第二项 (不同的二次因子)将分子拆开：
    \begin{align*}
        \int \frac{1-x}{x^2 + 1} \,dx &= \int \frac{1}{x^2 + 1} \,dx - \int \frac{x}{x^2 + 1} \,dx \\
        &= \arctan x - \frac{1}{2}\int \frac{1}{x^2 + 1} d(x^2+1) \\
        &= \arctan x - \frac{1}{2}\ln(x^2 + 1)
    \end{align*}

    第三项 (重复的二次因子)将分子拆开：
    $$\int \frac{3x - 2}{(x^2 + 1)^2} \,dx = \int \frac{3x}{(x^2 + 1)^2} \,dx - \int \frac{2}{(x^2 + 1)^2} \,dx$$
    $\int \frac{3x}{(x^2 + 1)^2} \,dx$: 使用代换 $u = x^2 + 1$, $du = 2x \,dx$
    $$\frac{3}{2} \int \frac{1}{u^2} du = \frac{3}{2} \left(-\frac{1}{u}\right) = \-\frac{3}{2(x^2 + 1)}$$

    $\int \frac{2}{(x^2 + 1)^2} \,dx$: 需要使用三角代换 $x = \tan\theta$, $\,dx = \sec^2\theta d\theta$
    \begin{align*}
        \int \frac{2}{(\tan^2\theta + 1)^2} \sec^2\theta d\theta &= \int \frac{2}{(\sec^2\theta)^2} \sec^2\theta d\theta \\
        &= 2 \int \frac{1}{\sec^2\theta} d\theta = 2 \int \cos^2\theta d\theta \\
        &= 2 \int \frac{1 + \cos(2\theta)}{2} d\theta = \int (1 + \cos(2\theta)) d\theta \\
        &= \theta + \frac{1}{2}\sin(2\theta) = \theta + \sin\theta\cos\theta
    \end{align*}

    因为 $x = \tan\theta$, 所以 $\theta = \arctan x$。
    
    由三角函数关系可知 $\sin\theta = \frac{x}{\sqrt{x^2+1}}$ 且 $\cos\theta = \frac{1}{\sqrt{x^2+1}}$。
    所以 $$\int \frac{2}{(x^2 + 1)^2} \,dx = \arctan x + \frac{x}{x^2 + 1}$$

    最终结果

    将所有部分相加：
    \begin{align*}
        &\int \frac{x^3 + 4x^2 - x + 1}{x(x^2 + 1)^2} \,dx \\
        &= \ln|x| + \arctan x - \frac{1}{2} \ln(x^2 + 1) - \frac{3}{2(x^2 + 1)} - \left( \arctan x + \frac{x}{x^2 + 1} \right) \\
        &= \ln|x| - \frac{1}{2} \ln(x^2 + 1) - \frac{3}{2(x^2 + 1)} - \frac{x}{x^2 + 1} + C \\
        &= \ln \left| \frac{x}{\sqrt{x^2 + 1}} \right| - \frac{2x + 3}{2(x^2 + 1)} + C
    \end{align*}
\end{example}

可以看到，包含重复因子和二次因子的分解步骤与基础情况相同，但确定系数和积分求解过程会复杂很多。

部分分式法是微积分中处理有理函数积分的基础工具，关键在于正确分解分母并准确构造部分分式。

\medskip

\textbf{4. 三角函数积分法}

三角函数的积分通常需要结合三角恒等式和换元法来求解。

\medskip

（1） 降幂与倍角恒等式积分（针对偶次幂）

当积分中包含 $\sin x$ 或 $\cos x$ 的偶次幂时，核心策略是使用降幂公式将其转化为 $\cos(2nx)$ 的线性组合。

核心公式：
$$\sin^2 x = \frac{1 - \cos 2x}{2} \qquad \cos^2 x = \frac{1 + \cos 2x}{2}$$

\begin{example} 求积分 $\int \cos^2 x \,dx$。
    \begin{align*}
        \int \cos^2 x \,dx &= \int \frac{1 + \cos 2x}{2} \,dx & \quad \text{(使用降幂公式)} \\ 
        &= \frac{1}{2} \int (1 + \cos 2x) \,dx \\ 
        &= \frac{1}{2} \left( \int 1 \,dx + \int \cos 2x \,dx \right) \\ 
        &= \frac{1}{2} \left( x + \frac{1}{2} \sin 2x \right) + C & \quad \text{(使用 $u=2x$ 换元)} \\ 
        &= \frac{1}{2} x + \frac{1}{4} \sin 2x + C
    \end{align*}
\end{example}

\begin{example} 求积分 $\int \sin^4 x \,dx$。

    第一次降幂： 将 $\sin^4 x$ 视为 $(\sin^2 x)^2$，使用降幂公式 $\sin^2 x = \frac{1 - \cos 2x}{2}$。
    \begin{align*} 
        \int \sin^4 x \, dx &= \int \left(\sin^2 x\right)^2 \,dx \\ 
        &= \int \left(\frac{1 - \cos 2x}{2}\right)^2 \,dx \\ 
        &= \frac{1}{4} \int (1 - 2\cos 2x + \cos^2 2x) \,dx
    \end{align*}

    第二次降幂： 对 $\cos^2 2x$ 使用降幂公式 $\cos^2 \theta = \frac{1 + \cos 2\theta}{2}$，其中 $\theta = 2x$。
    $$\cos^2 2x = \frac{1 + \cos(2 \cdot 2x)}{2} = \frac{1 + \cos 4x}{2}$$

    代入并积分：
    \begin{align*} 
        \int \sin^4 x \,dx &= \frac{1}{4} \int \left( 1 - 2\cos 2x + \frac{1 + \cos 4x}{2} \right) \,dx \\ 
        &= \frac{1}{4} \int \left( \frac{3}{2} - 2\cos 2x + \frac{1}{2}\cos 4x \right) \,dx \\ 
        &= \frac{1}{4} \left( \frac{3}{2} x - 2 \cdot \frac{1}{2}\sin 2x + \frac{1}{2} \cdot \frac{1}{4}\sin 4x \right) + C \\ 
        &= \frac{3}{8} x - \frac{1}{4}\sin 2x + \frac{1}{32}\sin 4x + C
    \end{align*}
\end{example}

\medskip

（2）奇次幂的积分（$u$ 换元法）

当积分形如 $\int \sin^m x \cos^n x \,dx$，且 $m$ 或 $n$ 至少有一个是正奇数时，我们使用 $u$ 换元法。

留下一个奇数次幂的因子（如 $\sin x$ 或 $\cos x$）作为 $du$ 的一部分。

将剩余的偶次幂因子利用 $\sin^2 x + \cos^2 x = 1$ 的关系，转化成另一个三角函数。

\medskip

\begin{example} 求积分 $\int \sin^3 x \cos^2 x \,dx$。

    $m=3$ 是奇数，我们留下一个 $\sin x$：
    
    变形： $\sin^3 x \cos^2 x = \sin^2 x \cos^2 x \cdot \sin x = (1 - \cos^2 x) \cos^2 x \cdot \sin x$
    
    换元： 令 $u = \cos x$，则 $du = -\sin x \, dx$，即 $\sin x \, dx = -du$。
    
    代入：
    \begin{align*} 
        \int \sin^3 x \cos^2 x \, dx &= \int (1 - \cos^2 x) \cos^2 x \cdot \sin x \, dx \\ 
        &= \int (1 - u^2) u^2 (-du) \\ 
        &= \int (u^4 - u^2) \, du \\ 
        &= \frac{u^5}{5} - \frac{u^3}{3} + C \\ 
        &= \frac{\cos^5 x}{5} - \frac{\cos^3 x}{3} + C
    \end{align*}
\end{example}

\begin{example} 求积分 $\int \sin^2 x \cos^5 x \,dx$。

    $n=5$ 是奇数，我们留下一个 $\cos x$ 作为 $du$ 的部分。
    
    变形： 提取一个 $\cos x$，将剩余的 $\cos^4 x$ 转化为 $\sin x$ 的形式。
    \begin{align*} 
        \sin^2 x \cos^5 x &= \sin^2 x \cos^4 x \cdot \cos x \\ 
        &= \sin^2 x (\cos^2 x)^2 \cdot \cos x \\ 
        &= \sin^2 x (1 - \sin^2 x)^2 \cdot \cos x
    \end{align*}

    换元： 令 $u = \sin x$，则 $du = \cos x \,dx$。
    
    代入并积分：
    \begin{align*} 
        \int \sin^2 x \cos^5 x \,dx &= \int u^2 (1 - u^2)^2 \,du \\ 
        &= \int u^2 (1 - 2u^2 + u^4) \,du \\ 
        &= \int (u^2 - 2u^4 + u^6) \,du \\ 
        &= \frac{1}{3}u^3 - \frac{2}{5}u^5 + \frac{1}{7}u^7 + C
    \end{align*}

    替换回 $x$：
    $$\int \sin^2 x \cos^5 x \,dx = \frac{1}{3}\sin^3 x - \frac{2}{5}\sin^5 x + \frac{1}{7}\sin^7 x + C$$
\end{example}

\medskip

（3）万能换元法（针对三角有理函数）

对于任何形如 $\int R(\sin x, \cos x) \,dx$ 的有理函数积分（$R$ 是关于 $\sin x$ 和 $\cos x$ 的多项式的比），万能换元法保证能将其转化为关于新变量 $t$ 的有理函数积分，理论上总能求解。

核心换元：令 $t = \tan \frac{x}{2}$。

核心替换关系：$$\sin x = \frac{2t}{1 + t^2} \qquad \cos x = \frac{1 - t^2}{1 + t^2} \qquad dx = \frac{2}{1 + t^2} \,dt$$

\medskip

\begin{example} 求积分 $\int \frac{1}{3 + 5 \cos x} \,dx$。

    代入万能换元公式：
    \begin{align*} 
        \int \frac{1}{3 + 5 \cos x} \,x &= \int \frac{1}{3 + 5 \left(\frac{1 - t^2}{1 + t^2}\right)} \cdot \frac{2}{1 + t^2} \,dt \\ 
        &= \int \frac{1}{\frac{3(1 + t^2) + 5(1 - t^2)}{1 + t^2}} \cdot \frac{2}{1 + t^2} \,dt \\ 
        &= \int \frac{1 + t^2}{(3 + 3t^2) + (5 - 5t^2)} \cdot \frac{2}{1 + t^2} \,dt \\ 
        &= \int \frac{2}{8 - 2t^2} \,dt \\ 
        &= \int \frac{1}{4 - t^2} \,dt
    \end{align*}

    部分分式分解： 
    $$\frac{1}{4 - t^2} = \frac{1}{(2 - t)(2 + t)} = \frac{1}{4} \left( \frac{1}{2 + t} + \frac{1}{2 - t} \right)$$

    积分：
    \begin{align*} 
        \int \frac{1}{4 - t^2} \,dt &= \frac{1}{4} \int \left( \frac{1}{2 + t} + \frac{1}{2 - t} \right) \,dt \\ 
        &= \frac{1}{4} \left( \ln|2 + t| - \ln|2 - t| \right) + C \\ 
        &= \frac{1}{4} \ln \left| \frac{2 + t}{2 - t} \right| + C
    \end{align*}

    替换回 $x$： 
    $$\int \frac{1}{3 + 5 \cos x} \,x = \frac{1}{4} \ln \left| \frac{2 + \tan \frac{x}{2}}{2 - \tan \frac{x}{2}} \right| + C$$
\end{example}

\medskip

（4）其它 $u$ 换元应用

对于涉及 $\sec x$, $\tan x$, $\csc x$, $\cot x$ 的积分，常常通过恒等式将其转化为 $\sin x$ 和 $\cos x$ 的形式，或直接使用特定的 $u$ 换元。

\medskip

\begin{example} 求积分 $\int \tan^3 x \,dx$。

    变形： $\tan^3 x = \tan x \cdot \tan^2 x = \tan x (\sec^2 x - 1)$
    $$\int \tan^3 x \,dx = \int \tan x \sec^2 x \,dx - \int \tan x \,dx$$

    第一个积分（$u$ 换元）：$\int \tan x \sec^2 x \,dx$
    
    令 $u = \tan x$，则 $du = \sec^2 x \,dx$。
    
    $\int u \,du = \frac{u^2}{2} = \frac{1}{2} \tan^2 x$

    第二个积分（基础公式）：$\int \tan x \, dx = -\ln|\cos x|$

    合并：$$\int \tan^3 x \,dx = \frac{1}{2} \tan^2 x + \ln|\cos x| + C$$

\end{example}

相对来说微分很简单，但积分却不是。 在求函数的导数时，通常很清楚必须应用哪个公式，但应该使用哪种方法来积分给定函数可能并不明显。由于本节的积分问题都集中在对应的方法上，因此通常很清楚对给定的积分时使用什么方法。

无论如何，熟练掌握基础公式的推导过程和基本应用是提高积分技术的基础。

